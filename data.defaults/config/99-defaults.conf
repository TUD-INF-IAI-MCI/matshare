# MatShare Configuration Defaults
#
# DO NOT EDIT THIS FILE DIRECTLY!
#
# It's strongly recommended that you include only those settings you want to override
# in a file named "config". All missing values are then loaded from this defaults file.
#
# The config file is sourced by bash before starting MatShare, so you can use full bash
# syntax. All variables set are automatically exported to the environment of MatShare.


# Main settings

# URL under which MatShare is accessible to the public. This will, for instance,
# be used in emails.
MS_URL=${MS_URL:-"http://localhost:8000"}

# Whether to run in debug (1) or production mode (0)
MS_DEBUG=${MS_DEBUG:-0}

# Set a random string; something like 'pwgen -1sy 100' should suffice.
# Required in production mode.
#MS_SECRET_KEY="..."
if [ -z "$MS_SECRET_KEY" ]; then
	if [ "$MS_DEBUG" != "1" ]; then
		echo "MS_SECRET_KEY must be configured in production mode" >&2
		return 1
	fi
	MS_SECRET_KEY="unsecure"
fi

# The default language in case the user's preference can't be detected
MS_LANGUAGE_CODE=${MS_LANGUAGE_CODE:-"en"}

# Dates will be displayed in this time zone by default; select one from:
# https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
MS_TIME_ZONE=${MS_TIME_ZONE:-"America/Chicago"}

# When running for the first time, create a superuser with these properties
MS_ADMIN_USER=${MS_ADMIN_USER:-"admin"}
MS_ADMIN_PASSWORD=${MS_ADMIN_PASSWORD:-"admin"}
MS_ADMIN_EMAIL=${MS_ADMIN_EMAIL:-"my.email@my.domain"}

# When an error occurs in production mode, these comma-separated addresses
# will be notified with information about the error. The report may include
# sensitive data.
MS_ERROR_EMAILS=${MS_ERROR_EMAILS:-""}

# Will be used for signatures of administrative commits.
# This has to be a plain e-mail address without name.
MS_GIT_ADMIN_EMAIL=${MS_GIT_ADMIN_EMAIL:-${MS_ADMIN_EMAIL}}


# Your PostgreSQL database connection
# :REQUIRED:

#MS_DB_HOST="..."
MS_DB_PORT=${MS_DB_PORT:-5432}
#MS_DB_NAME="..."
#MS_DB_USER="..."
#MS_DB_PASSWORD="..."


# Settings regarding e-mail sending

# Used as From: header when sending a mail
MS_DEFAULT_FROM_EMAIL=${MS_DEFAULT_FROM_EMAIL:-"MatShare <${MS_ADMIN_EMAIL}>"}

# Set in Reply-To header of sent emails
MS_CONTACT_EMAIL=${MS_CONTACT_EMAIL:-"${MS_DEFAULT_FROM_EMAIL}"}

# Server for sending mails
MS_EMAIL_HOST=${MS_EMAIL_HOST:-"localhost"}
MS_EMAIL_PORT=${MS_EMAIL_PORT:-25}

# Optionally, set credentialsfor SMTP authentication
MS_EMAIL_HOST_USER=${MS_EMAIL_HOST_USER:-""}
MS_EMAIL_HOST_PASSWORD=${MS_EMAIL_HOST_PASSWORD:-""}

# TLS means using STARTTLS, SSL means plain SSL below SMTP. These are mutually
# exclusive.
MS_EMAIL_USE_SSL=${MS_EMAIL_USE_SSL:-0}
MS_EMAIL_USE_TLS=${MS_EMAIL_USE_TLS:-0}


# LDAP Authentication

# If users should be able to authenticate against an external LDAP database,
# set this to 1. The following settings in this section marked as mandatory
# are of course only required when LDAP authentication is turned on.
MS_AUTH_LDAP=${MS_AUTH_LDAP:-0}

# This must point to your LDAP server; multiple space-separated URIs are
# supported.
# :REQUIRED:
#MS_AUTH_LDAP_SERVER_URI="ldap://ldap.example.com"

# Only direct binding is supported, search & bind is not possible for now.
# Template to construct a user's DN out of his username. "%(user)s" is replaced with
# the username trying to authenticate.
# :REQUIRED:
#MS_AUTH_LDAP_USER_DN_TEMPLATE="uid=%(user)s,ou=people,dc=example,dc=com"

# If you set this to the DN of a group, only members of that group can log in.
# You may also use a syntax similar to that of search filters in OpenLDAP
# (sample DNs shortened for better readability):
# |(cn=admins,ou=...)(&(cn=students,ou=...)(~(cn=first_term,ou=...)))
# This would permit login for:
# * users in the admins group OR
# * users in the students AND NOT in the first_term group
MS_AUTH_LDAP_REQUIRE_GROUP=${MS_AUTH_LDAP_REQUIRE_GROUP:-""}

# LDAP user attributes to populate the MatShare user account from.
# A login is only possible if the server provides all attributes.
MS_AUTH_LDAP_USER_ATTR_EMAIL=${MS_AUTH_LDAP_USER_ATTR_EMAIL:-"mail"}
MS_AUTH_LDAP_USER_ATTR_FIRST_NAME=${MS_AUTH_LDAP_USER_ATTR_FIRST_NAME:-"givenName"}
MS_AUTH_LDAP_USER_ATTR_LAST_NAME=${MS_AUTH_LDAP_USER_ATTR_LAST_NAME:-"sn"}


# Settings for courses

# The branch material and source tracking happens on.
# Don't change after a course has been created!
MS_GIT_MAIN_REF=${MS_GIT_MAIN_REF:-"refs/heads/master"}

# Mapping of keys and values to add to git config when creating a repository
# Example: MS_GIT_EXTRA_CONFIG="core.someSetting=42,http.otherSetting=foo"
MS_GIT_EXTRA_CONFIG=${MS_GIT_EXTRA_CONFIG:-""}

# Subdirectories inside a course's git repository that hold edited material and
# sources. Don't change after a course has been created!
MS_GIT_EDIT_SUBDIR=${MS_GIT_EDIT_SUBDIR:-"edit"}
MS_GIT_SRC_SUBDIR=${MS_GIT_SRC_SUBDIR:-"src"}

# These are just default values, the fields can be changed on a per-course basis.
MS_COURSE_CONTRIBUTOR=${MS_COURSE_CONTRIBUTOR:-""}
MS_COURSE_PUBLISHER=${MS_COURSE_PUBLISHER:-""}


# Scaling

# Number of worker processes to run in parallel
MS_NUM_PROCESSES=${MS_NUM_PROCESSES:-2}

# You may want to set a number of OS threads to spawn per worker process to
# process requests, experiment with the numbers yourself, but higher doesn't
# automatically mean more performance, it doesn't scale linearly.
MS_NUM_THREADS=${MS_NUM_THREADS:-4}

# Number of processes to perform spooled tasks (such as material building)
MS_NUM_SPOOLER_PROCESSES=${MS_NUM_SPOOLER_PROCESSES:-2}

# Process up to this number of requests to git via HTTP concurrently
MS_GIT_ASYNC=${MS_GIT_ASYNC:-50}


# Miscellaneous Settings

# How long to wait before logging out an inactive user
MS_SESSION_EXPIRATION_SECS=${MS_SESSION_EXPIRATION_SECS:-3600}

# Whether staff members should be able to create new local users in MatShare.
MS_STAFF_CAN_CREATE_USERS=${MS_STAFF_CAN_CREATE_USERS:-1}

# Whether the password reset functionality for native users should be enabled.
# You'll probably want to disable it when using external authentication.
MS_PASSWORD_RESET=${MS_PASSWORD_RESET:-1}

# How long password reset links should be valid
MS_PASSWORD_RESET_EXPIRATION_HOURS=${MS_PASSWORD_RESET_EXPIRATION_HOURS:-2}

# Static files are hosted efficiently at ${MS_URL}/static. If, however, you want
# to host them elsewhere, specify the URL here. If this setting is specified, static
# files won't be served by MatShare anymore.
#MS_STATIC_URL: "${MS_URL}/static"


# Debugging Settings

# Debug logging is very verbose, so the loggers for which to enable it have to be
# listed explicitly, comma-separated
# Example: MS_DEBUG_LOGGERS="matshare,django.request"
MS_DEBUG_LOGGERS=${MS_DEBUG_LOGGERS:-""}
